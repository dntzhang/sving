{"version":3,"sources":["../src/matrix2d.js","../src/observe.js","../src/sving.js"],"names":["Matrix2D","a","b","c","d","tx","ty","this","setValues","DEG_TO_RAD","Math","PI","identity","prototype","append","a1","b1","c1","d1","appendTransform","x","y","scaleX","scaleY","rotation","skewX","skewY","regX","regY","r","cos","sin","copy","matrix","clone","toString","observe","target","arr","callback","_observe","$observer","eventPropArr","isArray","length","$observeProps","$observerPath","mock","prop","hasOwnProperty","isInArray","push","watch","isString","propertyChangedHandler","all","propChanged","onPropertyChanged","value","oldValue","path","rootName","_getRootName","i","len","handler","indexOf","call","self","methods","forEach","item","old","Array","slice","result","apply","arguments","RegExp","test","triggerStr","cprop","isFunction","currentValue","Object","defineProperty","get","set","obj","twoWay","objA","aProp","objB","bProp","name","split","add","size","svgNS","$","el","attr","key","substring","setAttributeNS","String","setAttribute","document","createElementNS","style","webkitTapHighlightColor","opacity","left","top","originX","originY","transform","getAttributeNS","getAttribute","_Sving","selector","width","height","parent","querySelector","svg","appendChild","line","x1","y1","x2","y2","rect","text","str","font","textContent","circle","to","pathTo","ellipse","rx","ry","image","imgOrSrc","xlink:href","tempImage","Image","onload","src","group","child","remove","removeChild","Sving","window","module","exports","sving"],"mappings":"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","file":"sving.min.js","sourcesContent":["﻿\nfunction Matrix2D(a, b, c, d, tx, ty) {\n  this.setValues(a, b, c, d, tx, ty)\n}\n\nMatrix2D.DEG_TO_RAD = Math.PI / 180\n\n\nMatrix2D.identity = null // set at bottom of class definition.\nMatrix2D.prototype = {\n  setValues: function (a, b, c, d, tx, ty) {\n    // don't forget to update docs in the constructor if these change:\n    this.a = (a == null) ? 1 : a\n    this.b = b || 0\n    this.c = c || 0\n    this.d = (d == null) ? 1 : d\n    this.tx = tx || 0\n    this.ty = ty || 0\n    return this\n  },\n\n  append: function (a, b, c, d, tx, ty) {\n    var a1 = this.a\n    var b1 = this.b\n    var c1 = this.c\n    var d1 = this.d\n    if (a != 1 || b != 0 || c != 0 || d != 1) {\n      this.a = a1 * a + c1 * b\n      this.b = b1 * a + d1 * b\n      this.c = a1 * c + c1 * d\n      this.d = b1 * c + d1 * d\n    }\n    this.tx = a1 * tx + c1 * ty + this.tx\n    this.ty = b1 * tx + d1 * ty + this.ty\n    return this\n  },\n\n  appendTransform: function (x, y, scaleX, scaleY, rotation, skewX, skewY, regX, regY) {\n    if (rotation % 360) {\n      var r = rotation * Matrix2D.DEG_TO_RAD\n      var cos = Math.cos(r)\n      var sin = Math.sin(r)\n    } else {\n      cos = 1\n      sin = 0\n    }\n\n    if (skewX || skewY) {\n      // TODO: can this be combined into a single append operation?\n      skewX *= Matrix2D.DEG_TO_RAD\n      skewY *= Matrix2D.DEG_TO_RAD\n      this.append(Math.cos(skewY), Math.sin(skewY), -Math.sin(skewX), Math.cos(skewX), x, y)\n      this.append(cos * scaleX, sin * scaleX, -sin * scaleY, cos * scaleY, 0, 0)\n    } else {\n      this.append(cos * scaleX, sin * scaleX, -sin * scaleY, cos * scaleY, x, y)\n    }\n\n    if (regX || regY) {\n      this.tx -= regX * this.a + regY * this.c\n      this.ty -= regX * this.b + regY * this.d\n    }\n    return this\n  },\n\n  identity: function () {\n    this.a = this.d = 1\n    this.b = this.c = this.tx = this.ty = 0\n    return this\n  },\n\n  copy: function (matrix) {\n    return this.setValues(matrix.a, matrix.b, matrix.c, matrix.d, matrix.tx, matrix.ty)\n  },\n\n  clone: function () {\n    return new Matrix2D(this.a, this.b, this.c, this.d, this.tx, this.ty)\n  },\n\n  toString: function () {\n    return \"[Matrix2D (a=\" + this.a + \" b=\" + this.b + \" c=\" + this.c + \" d=\" + this.d + \" tx=\" + this.tx + \" ty=\" + this.ty + \")]\"\n  }\n}\n\n\nMatrix2D.identity = new Matrix2D()\n\n\nexport default Matrix2D\n","﻿/* observejs --- By dnt http://kmdjs.github.io/\n * Github: https://github.com/kmdjs/observejs\n * MIT Licensed.\n */\n\nvar observe = function (target, arr, callback) {\n  var _observe = function (target, arr, callback) {\n    if (!target.$observer) target.$observer = this;\n    var $observer = target.$observer;\n    var eventPropArr = [];\n    if (observe.isArray(target)) {\n      if (target.length === 0) {\n        target.$observeProps = {};\n        target.$observeProps.$observerPath = \"#\";\n      }\n      $observer.mock(target);\n\n    }\n    for (var prop in target) {\n      if (target.hasOwnProperty(prop)) {\n        if (callback) {\n          if (observe.isArray(arr) && observe.isInArray(arr, prop)) {\n            eventPropArr.push(prop);\n            $observer.watch(target, prop);\n          } else if (observe.isString(arr) && prop == arr) {\n            eventPropArr.push(prop);\n            $observer.watch(target, prop);\n          }\n        } else {\n          eventPropArr.push(prop);\n          $observer.watch(target, prop);\n        }\n      }\n    }\n    $observer.target = target;\n    if (!$observer.propertyChangedHandler) $observer.propertyChangedHandler = [];\n    var propChanged = callback ? callback : arr;\n    $observer.propertyChangedHandler.push({ all: !callback, propChanged: propChanged, eventPropArr: eventPropArr });\n  }\n  _observe.prototype = {\n    \"onPropertyChanged\": function (prop, value, oldValue, target, path) {\n      if (value !== oldValue && this.propertyChangedHandler) {\n        var rootName = observe._getRootName(prop, path);\n        for (var i = 0, len = this.propertyChangedHandler.length; i < len; i++) {\n          var handler = this.propertyChangedHandler[i];\n          if (handler.all || observe.isInArray(handler.eventPropArr, rootName) || rootName.indexOf(\"Array-\") === 0) {\n            handler.propChanged.call(this.target, prop, value, oldValue, path);\n          }\n        }\n      }\n      if (prop.indexOf(\"Array-\") !== 0 && typeof value === \"object\") {\n        this.watch(target, prop, target.$observeProps.$observerPath);\n      }\n    },\n    \"mock\": function (target) {\n      var self = this;\n      observe.methods.forEach(function (item) {\n        target[item] = function () {\n          var old = Array.prototype.slice.call(this, 0);\n          var result = Array.prototype[item].apply(this, Array.prototype.slice.call(arguments));\n          if (new RegExp(\"\\\\b\" + item + \"\\\\b\").test(observe.triggerStr)) {\n            for (var cprop in this) {\n              if (this.hasOwnProperty(cprop) && !observe.isFunction(this[cprop])) {\n                self.watch(this, cprop, this.$observeProps.$observerPath);\n              }\n            }\n            //todo\n            self.onPropertyChanged(\"Array-\" + item, this, old, this, this.$observeProps.$observerPath);\n          }\n          return result;\n        };\n      });\n    },\n    \"watch\": function (target, prop, path) {\n      if (prop === \"$observeProps\" || prop === \"$observer\") return;\n      if (observe.isFunction(target[prop])) return;\n      if (!target.$observeProps) target.$observeProps = {};\n      if (path !== undefined) {\n        target.$observeProps.$observerPath = path;\n      } else {\n        target.$observeProps.$observerPath = \"#\";\n      }\n      var self = this;\n      var currentValue = target.$observeProps[prop] = target[prop];\n      Object.defineProperty(target, prop, {\n        get: function () {\n          return this.$observeProps[prop];\n        },\n        set: function (value) {\n          var old = this.$observeProps[prop];\n          this.$observeProps[prop] = value;\n          self.onPropertyChanged(prop, value, old, this, target.$observeProps.$observerPath);\n        }\n      });\n      if (typeof currentValue == \"object\") {\n        if (observe.isArray(currentValue)) {\n          this.mock(currentValue);\n          if (currentValue.length === 0) {\n            if (!currentValue.$observeProps) currentValue.$observeProps = {};\n            if (path !== undefined) {\n              currentValue.$observeProps.$observerPath = path;\n            } else {\n              currentValue.$observeProps.$observerPath = \"#\";\n            }\n          }\n        }\n        for (var cprop in currentValue) {\n          if (currentValue.hasOwnProperty(cprop)) {\n            this.watch(currentValue, cprop, target.$observeProps.$observerPath + \"-\" + prop);\n          }\n        }\n      }\n    }\n  }\n  return new _observe(target, arr, callback)\n}\nobserve.methods = [\"concat\", \"every\", \"filter\", \"forEach\", \"indexOf\", \"join\", \"lastIndexOf\", \"map\", \"pop\", \"push\", \"reduce\", \"reduceRight\", \"reverse\", \"shift\", \"slice\", \"some\", \"sort\", \"splice\", \"unshift\", \"toLocaleString\", \"toString\", \"size\"]\nobserve.triggerStr = [\"concat\", \"pop\", \"push\", \"reverse\", \"shift\", \"sort\", \"splice\", \"unshift\", \"size\"].join(\",\")\nobserve.isArray = function (obj) {\n  return Object.prototype.toString.call(obj) === '[object Array]';\n}\nobserve.isString = function (obj) {\n  return typeof obj === \"string\";\n}\nobserve.isInArray = function (arr, item) {\n  for (var i = arr.length; --i > -1;) {\n    if (item === arr[i]) return true;\n  }\n  return false;\n}\nobserve.isFunction = function (obj) {\n  return Object.prototype.toString.call(obj) == '[object Function]';\n}\nobserve.twoWay = function (objA, aProp, objB, bProp) {\n  if (typeof objA[aProp] === \"object\" && typeof objB[bProp] === \"object\") {\n    observe(objA, aProp, function (name, value) {\n      objB[bProp] = this[aProp];\n    })\n    observe(objB, bProp, function (name, value) {\n      objA[aProp] = this[bProp];\n    })\n  } else {\n    observe(objA, aProp, function (name, value) {\n      objB[bProp] = value;\n    })\n    observe(objB, bProp, function (name, value) {\n      objA[aProp] = value;\n    })\n  }\n}\nobserve._getRootName = function (prop, path) {\n  if (path === \"#\") {\n    return prop;\n  }\n  return path.split(\"-\")[1];\n}\n\nobserve.add = function (obj, prop, value) {\n  obj[prop] = value;\n  var $observer = obj.$observer;\n  $observer.watch(obj, prop);\n}\nArray.prototype.size = function (length) {\n  this.length = length;\n}\n\n\nexport default observe\n","﻿import Matrix2D from './matrix2d'\nimport observe from './observe'\n\nvar svgNS = \"http://www.w3.org/2000/svg\"\nvar xlink = \"http://www.w3.org/1999/xlink\"\nvar $ = function (el, attr) {\n  if (attr) {\n    if (typeof el == \"string\") {\n      el = $(el)\n    }\n    for (var key in attr) if (attr.hasOwnProperty(key)) {\n      if (key.substring(0, 6) == \"xlink:\") {\n        el.setAttributeNS(xlink, key.substring(6), String(attr[key]))\n      } else {\n        el.setAttribute(key, String(attr[key]))\n      }\n    }\n  } else {\n    el = document.createElementNS(\"http://www.w3.org/2000/svg\", el)\n    el.style && (el.style.webkitTapHighlightColor = \"rgba(0,0,0,0)\")\n    el.opacity = el.scaleX = el.scaleY = 1\n    el.left = el.top = el.rotation = el.skewX = el.skewY = el.originX = el.originY = 0\n    el.matrix = Matrix2D.identity\n    observe(el, [\"left\", \"top\", \"scaleX\", \"scaleY\", \"rotation\", \"skewX\", \"skewY\", \"originX\", \"originY\"], function () {\n\n      this.matrix.identity().appendTransform(this.left, this.top, this.scaleX, this.scaleY, this.rotation, this.skewX, this.skewY, this.originX, this.originY)\n\n      $(el, { \"transform\": \"matrix(\" + this.matrix.a + \",\" + this.matrix.b + \",\" + this.matrix.c + \",\" + this.matrix.d + \",\" + this.matrix.tx + \",\" + this.matrix.ty + \")\" })\n    })\n\n    observe(el, [\"opacity\"], function () {\n      el.setAttribute(\"opacity\", this.opacity)\n    })\n\n    el.attr = function (attr, value) {\n      if (arguments.length === 1) {\n        if (typeof attr === \"string\") {\n          if (attr.indexOf(\":\") !== -1) {\n            return this.getAttributeNS(svgNS, attr)\n          } else {\n            return this.getAttribute(attr)\n          }\n        } else {\n          return $(this, attr)\n        }\n      } else {\n        var obj = {}\n        obj[attr] = value\n        return $(this, obj)\n      }\n\n    }\n  }\n\n  return el\n}\n\nvar _Sving = function (selector, width, height) {\n  this.parent = typeof selector === \"string\" ? document.querySelector(selector) : selector\n  this.svg = document.createElementNS(svgNS, \"svg\")\n  //debug  'style', 'border: 1px solid black\n  this.svg.setAttribute('style', 'border: 1px solid blackoverflow: hidden')\n\n  this.svg.setAttribute('width', width)\n  this.svg.setAttribute('height', height)\n  this.svg.setAttributeNS(\"http://www.w3.org/2000/xmlns/\", \"xmlns:xlink\", \"http://www.w3.org/1999/xlink\")\n  this.parent.appendChild(this.svg)\n\n}\n\n_Sving.prototype = {\n  line: function (x1, y1, x2, y2, color) {\n    var line = $(\"line\", { x1: x1, y1: y1, x2: x2, y2: y2 })\n    this.svg.appendChild(line)\n\n    return line\n  },\n  rect: function (width, height) {\n    var rect = $(\"rect\", { width: width, height: height })\n    this.svg.appendChild(rect)\n\n    return rect\n  },\n  text: function (str, font) {\n    var text = $(\"text\")\n    text.style.font = font\n    text.textContent = str\n    this.svg.appendChild(text)\n    return text\n  },\n  circle: function (r) {\n    var circle = $(\"circle\", { r: r })\n    this.svg.appendChild(circle)\n    return circle\n  },\n  //   image   group\n  path: function (d) {\n\n    var path = $(\"path\", { d: d })\n    path.to = _Sving.pathTo\n    this.svg.appendChild(path)\n    return path\n  },\n  ellipse: function (rx, ry) {\n\n    var ellipse = $(\"ellipse\", { rx: rx, ry: ry })\n    this.svg.appendChild(ellipse)\n    return ellipse\n  },\n  image: function (imgOrSrc) {\n    if (typeof imgOrSrc === \"string\") {\n      var image = $(\"image\", { \"xlink:href\": imgOrSrc })\n      var tempImage = new Image()\n      tempImage.onload = function () {\n        image.attr({ width: tempImage.width, height: tempImage.height })\n        tempImage = null\n      }\n      tempImage.src = imgOrSrc\n    } else {\n      var image = $(\"image\", { \"xlink:href\": imgOrSrc, width: imgOrSrc.width, height: imgOrSrc.height })\n\n    }\n    this.svg.appendChild(image)\n    return image\n\n\n  },\n  group: function () {\n    var group = $(\"g\")\n    this.svg.appendChild(group)\n    var i = 0, len = arguments.length\n    for (; i < len; i++) {\n      group.appendChild(arguments[i])\n    }\n    group.add = function (child) {\n      group.appendChild(child)\n    }\n    group.remove = function (child) {\n      group.removeChild(child)\n    }\n    return group\n  },\n  remove: function (child) {\n    this.svg.removeChild(child)\n  }\n}\n\nvar Sving = function (selector, width, height) {\n\n  return new _Sving(selector, width, height)\n}\n\nwindow.Sving = Sving\n\nexport default Sving\n"]}