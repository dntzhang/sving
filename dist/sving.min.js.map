{"version":3,"sources":["../src/matrix2d.js","../src/obaa.js","../src/sving.js"],"names":["Matrix2D","a","b","c","d","tx","ty","this","setValues","obaa","target","arr","callback","eventPropArr","isArray","length","__o_","__r_","__p_","mock","Object","keys","track","prop","hasOwnProperty","isInArray","push","watch","isString","__c_","all","propChanged","root","methods","forEach","item","old","Array","prototype","slice","call","result","apply","arguments","RegExp","test","triggerStr","cprop","isFunction","onPropertyChanged","substring","toUpperCase","path","currentValue","defineProperty","get","set","value","configurable","enumerable","obj","oldValue","nan","rootName","getRootName","i","len","handler","indexOf","toString","isNaN","split","DEG_TO_RAD","Math","PI","identity","append","a1","b1","c1","d1","appendTransform","x","y","scaleX","scaleY","rotation","skewX","skewY","regX","regY","r","cos","sin","copy","matrix","clone","add","size","svgNS","$","el","attr","key","setAttributeNS","String","setAttribute","document","createElementNS","style","webkitTapHighlightColor","opacity","left","top","originX","originY","transform","getAttributeNS","getAttribute","_Sving","selector","width","height","parent","querySelector","svg","appendChild","line","x1","y1","x2","y2","rect","text","str","font","textContent","circle","to","pathTo","ellipse","rx","ry","image","imgOrSrc","xlink:href","tempImage","Image","onload","src","group","child","remove","removeChild","Sving","window","module","exports","sving","self"],"mappings":"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","file":"sving.min.js","sourcesContent":["﻿\nfunction Matrix2D(a, b, c, d, tx, ty) {\n  this.setValues(a, b, c, d, tx, ty)\n}\n\nMatrix2D.DEG_TO_RAD = Math.PI / 180\n\n\nMatrix2D.identity = null // set at bottom of class definition.\nMatrix2D.prototype = {\n  setValues: function (a, b, c, d, tx, ty) {\n    // don't forget to update docs in the constructor if these change:\n    this.a = (a == null) ? 1 : a\n    this.b = b || 0\n    this.c = c || 0\n    this.d = (d == null) ? 1 : d\n    this.tx = tx || 0\n    this.ty = ty || 0\n    return this\n  },\n\n  append: function (a, b, c, d, tx, ty) {\n    var a1 = this.a\n    var b1 = this.b\n    var c1 = this.c\n    var d1 = this.d\n    if (a != 1 || b != 0 || c != 0 || d != 1) {\n      this.a = a1 * a + c1 * b\n      this.b = b1 * a + d1 * b\n      this.c = a1 * c + c1 * d\n      this.d = b1 * c + d1 * d\n    }\n    this.tx = a1 * tx + c1 * ty + this.tx\n    this.ty = b1 * tx + d1 * ty + this.ty\n    return this\n  },\n\n  appendTransform: function (x, y, scaleX, scaleY, rotation, skewX, skewY, regX, regY) {\n    if (rotation % 360) {\n      var r = rotation * Matrix2D.DEG_TO_RAD\n      var cos = Math.cos(r)\n      var sin = Math.sin(r)\n    } else {\n      cos = 1\n      sin = 0\n    }\n\n    if (skewX || skewY) {\n      // TODO: can this be combined into a single append operation?\n      skewX *= Matrix2D.DEG_TO_RAD\n      skewY *= Matrix2D.DEG_TO_RAD\n      this.append(Math.cos(skewY), Math.sin(skewY), -Math.sin(skewX), Math.cos(skewX), x, y)\n      this.append(cos * scaleX, sin * scaleX, -sin * scaleY, cos * scaleY, 0, 0)\n    } else {\n      this.append(cos * scaleX, sin * scaleX, -sin * scaleY, cos * scaleY, x, y)\n    }\n\n    if (regX || regY) {\n      this.tx -= regX * this.a + regY * this.c\n      this.ty -= regX * this.b + regY * this.d\n    }\n    return this\n  },\n\n  identity: function () {\n    this.a = this.d = 1\n    this.b = this.c = this.tx = this.ty = 0\n    return this\n  },\n\n  copy: function (matrix) {\n    return this.setValues(matrix.a, matrix.b, matrix.c, matrix.d, matrix.tx, matrix.ty)\n  },\n\n  clone: function () {\n    return new Matrix2D(this.a, this.b, this.c, this.d, this.tx, this.ty)\n  },\n\n  toString: function () {\n    return \"[Matrix2D (a=\" + this.a + \" b=\" + this.b + \" c=\" + this.c + \" d=\" + this.d + \" tx=\" + this.tx + \" ty=\" + this.ty + \")]\"\n  }\n}\n\n\nMatrix2D.identity = new Matrix2D()\n\n\nexport default Matrix2D\n","﻿/*\n * obaa 2.1.0\n * By dntzhang\n * Github: https://github.com/Tencent/omi/tree/master/packages/obaa\n * MIT Licensed.\n */\n\n\n// __r_: root\n// __c_: prop change callback\n// __p_: path\n\nfunction obaa(target, arr, callback) {\n\n  var eventPropArr = []\n  if (isArray(target)) {\n    if (target.length === 0) {\n      target.__o_ = {\n        __r_: target,\n        __p_: '#'\n      }\n    }\n    mock(target, target)\n  }\n  if (target && typeof target === 'object' && Object.keys(target).length === 0) {\n    track(target)\n    target.__o_.__r_ = target\n  }\n  for (var prop in target) {\n    if (target.hasOwnProperty(prop)) {\n      if (callback) {\n        if (isArray(arr) && isInArray(arr, prop)) {\n          eventPropArr.push(prop)\n          watch(target, prop, null, target)\n        } else if (isString(arr) && prop == arr) {\n          eventPropArr.push(prop)\n          watch(target, prop, null, target)\n        }\n      } else {\n        eventPropArr.push(prop)\n        watch(target, prop, null, target)\n      }\n    }\n  }\n  if (!target.__c_) {\n    target.__c_ = []\n  }\n  var propChanged = callback ? callback : arr\n  target.__c_.push({\n    all: !callback,\n    propChanged: propChanged,\n    eventPropArr: eventPropArr\n  })\n}\n\nvar triggerStr = [\n  'concat',\n  'copyWithin',\n  'fill',\n  'pop',\n  'push',\n  'reverse',\n  'shift',\n  'sort',\n  'splice',\n  'unshift',\n  'size'\n].join(',')\n\nvar methods = [\n  'concat',\n  'copyWithin',\n  'entries',\n  'every',\n  'fill',\n  'filter',\n  'find',\n  'findIndex',\n  'forEach',\n  'includes',\n  'indexOf',\n  'join',\n  'keys',\n  'lastIndexOf',\n  'map',\n  'pop',\n  'push',\n  'reduce',\n  'reduceRight',\n  'reverse',\n  'shift',\n  'slice',\n  'some',\n  'sort',\n  'splice',\n  'toLocaleString',\n  'toString',\n  'unshift',\n  'values',\n  'size'\n]\n\nfunction mock(target, root) {\n  methods.forEach(function (item) {\n    target[item] = function () {\n      var old = Array.prototype.slice.call(this, 0)\n      var result = Array.prototype[item].apply(\n        this,\n        Array.prototype.slice.call(arguments)\n      )\n      if (new RegExp('\\\\b' + item + '\\\\b').test(triggerStr)) {\n        for (var cprop in this) {\n          if (\n            this.hasOwnProperty(cprop) &&\n            !isFunction(this[cprop])\n          ) {\n            watch(this, cprop, this.__o_.__p_, root)\n          }\n        }\n        //todo\n        onPropertyChanged(\n          'Array-' + item,\n          this,\n          old,\n          this,\n          this.__o_.__p_,\n          root\n        )\n      }\n      return result\n    }\n    target[\n      'pure' + item.substring(0, 1).toUpperCase() + item.substring(1)\n    ] = function () {\n      return Array.prototype[item].apply(\n        this,\n        Array.prototype.slice.call(arguments)\n      )\n    }\n  })\n}\n\nfunction watch(target, prop, path, root) {\n  if (prop === '__o_') return\n  if (isFunction(target[prop])) return\n  if (!target.__o_) target.__o_ = {\n    __r_: root\n  }\n  if (path !== undefined && path !== null) {\n    target.__o_.__p_ = path\n  } else {\n    target.__o_.__p_ = '#'\n  }\n\n  var currentValue = (target.__o_[prop] = target[prop])\n  Object.defineProperty(target, prop, {\n    get: function () {\n      return this.__o_[prop]\n    },\n    set: function (value) {\n      var old = this.__o_[prop]\n      this.__o_[prop] = value\n      onPropertyChanged(\n        prop,\n        value,\n        old,\n        this,\n        target.__o_.__p_,\n        root\n      )\n    },\n    configurable: true,\n    enumerable: true\n  })\n  if (typeof currentValue == 'object') {\n    if (isArray(currentValue)) {\n      mock(currentValue, root)\n      if (currentValue.length === 0) {\n        track(currentValue, prop, path)\n      }\n    }\n    if (currentValue && Object.keys(currentValue).length === 0) {\n      track(currentValue, prop, path)\n    }\n    for (var cprop in currentValue) {\n      if (currentValue.hasOwnProperty(cprop)) {\n        watch(\n          currentValue,\n          cprop,\n          target.__o_.__p_ + '-' + prop,\n          root\n        )\n      }\n    }\n  }\n}\n\nfunction track(obj, prop, path) {\n  if (obj.__o_) {\n    return\n  }\n  obj.__o_ = {}\n  if (path !== undefined && path !== null) {\n    obj.__o_.__p_ = path + '-' + prop\n  } else {\n    if (prop !== undefined && prop !== null) {\n      obj.__o_.__p_ = '#' + '-' + prop\n    } else {\n      obj.__o_.__p_ = '#'\n    }\n  }\n}\n\n\nfunction onPropertyChanged(prop, value, oldValue, target, path, root) {\n  if (value !== oldValue && (!(nan(value) && nan(oldValue))) && root.__c_) {\n    var rootName = getRootName(prop, path)\n    for (\n      var i = 0, len = root.__c_.length;\n      i < len;\n      i++\n    ) {\n      var handler = root.__c_[i]\n      if (\n        handler.all ||\n        isInArray(handler.eventPropArr, rootName) ||\n        rootName.indexOf('Array-') === 0\n      ) {\n        handler.propChanged.call(target, prop, value, oldValue, path)\n      }\n    }\n  }\n\n  if (prop.indexOf('Array-') !== 0 && typeof value === 'object') {\n    watch(target, prop, target.__o_.__p_, root)\n  }\n}\n\nfunction isFunction(obj) {\n  return Object.prototype.toString.call(obj) == '[object Function]'\n}\n\nfunction nan(value) {\n  return typeof value === \"number\" && isNaN(value)\n}\n\nfunction isArray(obj) {\n  return Object.prototype.toString.call(obj) === '[object Array]'\n}\n\nfunction isString(obj) {\n  return typeof obj === 'string'\n}\n\nfunction isInArray(arr, item) {\n  for (var i = arr.length; --i > -1;) {\n    if (item === arr[i]) return true\n  }\n  return false\n}\n\n\nfunction getRootName(prop, path) {\n  if (path === '#') {\n    return prop\n  }\n  return path.split('-')[1]\n}\n\nobaa.add = function (obj, prop) {\n  watch(obj, prop, obj.__o_.__p_, obj.__o_.__r_)\n}\n\nobaa.set = function (obj, prop, value) {\n  if (obj[prop] === undefined) {\n    watch(obj, prop, obj.__o_.__p_, obj.__o_.__r_)\n  }\n  obj[prop] = value\n}\n\nArray.prototype.size = function (length) {\n  this.length = length\n}\n\n\nexport default obaa\n","﻿import Matrix2D from './matrix2d'\nimport obaa from './obaa'\n\nvar svgNS = \"http://www.w3.org/2000/svg\"\nvar xlink = \"http://www.w3.org/1999/xlink\"\nvar $ = function (el, attr) {\n  if (attr) {\n    if (typeof el == \"string\") {\n      el = $(el)\n    }\n    for (var key in attr) if (attr.hasOwnProperty(key)) {\n      if (key.substring(0, 6) == \"xlink:\") {\n        el.setAttributeNS(xlink, key.substring(6), String(attr[key]))\n      } else {\n        el.setAttribute(key, String(attr[key]))\n      }\n    }\n  } else {\n    el = document.createElementNS(\"http://www.w3.org/2000/svg\", el)\n    el.style && (el.style.webkitTapHighlightColor = \"rgba(0,0,0,0)\")\n    el.opacity = el.scaleX = el.scaleY = 1\n    el.left = el.top = el.rotation = el.skewX = el.skewY = el.originX = el.originY = 0\n    el.matrix = Matrix2D.identity\n    obaa(el, [\"left\", \"top\", \"scaleX\", \"scaleY\", \"rotation\", \"skewX\", \"skewY\", \"originX\", \"originY\"], function () {\n\n      this.matrix.identity().appendTransform(this.left, this.top, this.scaleX, this.scaleY, this.rotation, this.skewX, this.skewY, this.originX, this.originY)\n\n      $(el, { \"transform\": \"matrix(\" + this.matrix.a + \",\" + this.matrix.b + \",\" + this.matrix.c + \",\" + this.matrix.d + \",\" + this.matrix.tx + \",\" + this.matrix.ty + \")\" })\n    })\n\n    obaa(el, [\"opacity\"], function () {\n      el.setAttribute(\"opacity\", this.opacity)\n    })\n\n    el.attr = function (attr, value) {\n      if (arguments.length === 1) {\n        if (typeof attr === \"string\") {\n          if (attr.indexOf(\":\") !== -1) {\n            return this.getAttributeNS(svgNS, attr)\n          } else {\n            return this.getAttribute(attr)\n          }\n        } else {\n          return $(this, attr)\n        }\n      } else {\n        var obj = {}\n        obj[attr] = value\n        return $(this, obj)\n      }\n\n    }\n  }\n\n  return el\n}\n\nvar _Sving = function (selector, width, height) {\n  this.parent = typeof selector === \"string\" ? document.querySelector(selector) : selector\n  this.svg = document.createElementNS(svgNS, \"svg\")\n  //debug  'style', 'border: 1px solid black\n  this.svg.setAttribute('style', 'border: 1px solid blackoverflow: hidden')\n\n  this.svg.setAttribute('width', width)\n  this.svg.setAttribute('height', height)\n  this.svg.setAttributeNS(\"http://www.w3.org/2000/xmlns/\", \"xmlns:xlink\", \"http://www.w3.org/1999/xlink\")\n  this.parent.appendChild(this.svg)\n\n}\n\n_Sving.prototype = {\n  line: function (x1, y1, x2, y2, color) {\n    var line = $(\"line\", { x1: x1, y1: y1, x2: x2, y2: y2 })\n    this.svg.appendChild(line)\n\n    return line\n  },\n  rect: function (width, height) {\n    var rect = $(\"rect\", { width: width, height: height })\n    this.svg.appendChild(rect)\n\n    return rect\n  },\n  text: function (str, font) {\n    var text = $(\"text\")\n    text.style.font = font\n    text.textContent = str\n    this.svg.appendChild(text)\n    return text\n  },\n  circle: function (r) {\n    var circle = $(\"circle\", { r: r })\n    this.svg.appendChild(circle)\n    return circle\n  },\n  //   image   group\n  path: function (d) {\n\n    var path = $(\"path\", { d: d })\n    path.to = _Sving.pathTo\n    this.svg.appendChild(path)\n    return path\n  },\n  ellipse: function (rx, ry) {\n\n    var ellipse = $(\"ellipse\", { rx: rx, ry: ry })\n    this.svg.appendChild(ellipse)\n    return ellipse\n  },\n  image: function (imgOrSrc) {\n    if (typeof imgOrSrc === \"string\") {\n      var image = $(\"image\", { \"xlink:href\": imgOrSrc })\n      var tempImage = new Image()\n      tempImage.onload = function () {\n        image.attr({ width: tempImage.width, height: tempImage.height })\n        tempImage = null\n      }\n      tempImage.src = imgOrSrc\n    } else {\n      var image = $(\"image\", { \"xlink:href\": imgOrSrc, width: imgOrSrc.width, height: imgOrSrc.height })\n\n    }\n    this.svg.appendChild(image)\n    return image\n\n\n  },\n  group: function () {\n    var group = $(\"g\")\n    this.svg.appendChild(group)\n    var i = 0, len = arguments.length\n    for (; i < len; i++) {\n      group.appendChild(arguments[i])\n    }\n    group.add = function (child) {\n      group.appendChild(child)\n    }\n    group.remove = function (child) {\n      group.removeChild(child)\n    }\n    return group\n  },\n  remove: function (child) {\n    this.svg.removeChild(child)\n  }\n}\n\nvar Sving = function (selector, width, height) {\n\n  return new _Sving(selector, width, height)\n}\n\nwindow.Sving = Sving\n\nexport default Sving\n"]}